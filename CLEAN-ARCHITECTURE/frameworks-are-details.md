# 프레임워크는 세부사항이다

## 1. 프레임워크 제작자

- 대다수의 프레임워크 제작자는 커뮤니티에 도움이 되기를 바라는 마음에 자신의 작업물을 무료로 제공한다.
- 하지만 이들은 당신이 풀어야 할 **특별한 관심사**를 염두에 두지 않는다.
- 프레임워크 제작자는 당신을 알지 못하며, 당신이 풀어야 할 문제도 알지 못한다.

## 2. 혼인 관계의 비대칭성

- 당신과 프레임워크 제작자 사이의 관계는 놀라울 정도로 **비대칭적**이다.
  - 당신은 프레임워크를 위해 대단히 큰 헌신을 해야 하지만, 프레임워크 제작자는 당신을 위해 아무런 헌신도 하지 않는다.
- 대개의 경우 이들은 프레임워크를 중심에 두고 **우리의 아키텍처는 그 바깥을 감싸야 한다고** 말한다.
  - 또한 이들은 프레임워크의 기반 클래스에서 직접 파생하거나, 프레임워크의 기능들을 업무 객체에 바로 임포트해서 사용하라고 권한다.
  - 프레임워크 제작자는 당신의 애플리케이션이 가능하면 프레임워크에 **공고하게 결합될 것**을 강하게 역설한다.
  - 프레임워크 제작자는 그 프레임워크에 대한 제어권을 쥐고 있기 때문이다.

## 3. 위험 요인

- 프레임워크의 아키텍처는 그다지 깔끔하지 않은 경우가 많다.
  - 프레임워크는 **의존성 규칙을 위반**하는 경향이 있다.
  - 업무 객체를 만들 때, 프레임워크 제작자는 자신의 코드를 상속할 것을 요구한다.
  - 따라서 프레임워크가 **가장 안쪽 원과 결합되기를 원하며** 한 번 결합되면 떼어내기 어렵다.
- 프레임워크는 애플리케이션의 초기 기능을 만들 때는 도움이 되지만, 제품이 성숙해지면서 프레임워크가 제공하는 기능과 틀을 벗어나야 하는 경우가 많아진다.
- 프레임워크는 도움이 되지 않는 방향으로 진화할 수 있다. 도움도 되지 않는 신규 버전으로 업그레이드하느라 다른 일을 못할 수도 있다.
  - 심지어 사용 중이던 기능이 사라지거나 반영하기 힘든 형태로 변경될 수 있다.
- 새롭고 더 나은 프레임워크로 갈아타고 싶을 수도 있다.

## 4. 해결책

- **프레임워크와 결혼하지 말라.**
- 프레임워크를 사용할 수는 있지만, **결합해서는 안 된다**.
  - 프레임워크는 **가장 바깥쪽 원**에 속하는 **세부사항**으로 취급해라.
- 업무 객체를 만들 때 프레임워크가 자신의 기반 클래스로부터 파생하기를 요구한다면, **거절하라**.
  - 대신 **프록시(Proxy)** 를 만들고, 업무 규칙에 플러그인할 수 있는 컴포넌트에 이들 프록시를 위치시켜라.
- 프레임워크가 핵심 코드 안으로 들어오지 못하게 하라.
  - 대신 핵심 코드에 플러그인할 수 있는 컴포넌트에 프레임워크를 통합하고 **의존성 규칙을 준수하라**.
- 예를 들어 스프링(Spring) 프레임워크를 사용할 때 스프링의 오토와이어링(Auto-wiring) 기능을 사용할 것이다.
  - 이 방법도 좋지만 `@Autowired` 어노테이션이 업무 객체 도처에 산재해서는 **안 된다**.
  - **업무 객체는 절대로 스프링에 대해 알아서는 안 된다.**
- 업무 객체보다는 **메인(Main) 컴포넌트**에서 스프링을 사용해서 의존성을 주입하는 편이 낫다.
  - 메인은 아키텍처 내에서 가장 지저분한, **최저 수준의 컴포넌트**이기 때문이다.

## 5. 이제 선언합니다

- 정말 결혼해야만 하는 프레임워크도 존재한다.
  - C++를 사용 중이라면 STL과 결혼해야 할 가능성이 높다.
  - 자바를 사용한다면 표준 라이브러리와 반드시 결혼해야 한다.
- 이러한 관계는 정상이다. 하지만 철저히 **선택적이어야** 한다.

## 6. 결론

- 프레임워크와의 **첫 만남부터 결혼하려 들지 말라**.
  - 가급적이면 프레임워크를 가능한 오랫동안 **아키텍처 경계 너머에** 두어야 한다.
