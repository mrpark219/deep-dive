# HTTP 메서드

## 1. HTTP API를 만들어보자

### 1.1 회원 정보 관리 API

#### 1.1.1 URI 설계 - 리소스 식별

- 행위는 URI에 포함되지 않는다. (등록, 조회, 수정, 삭제 등)
- 회원이라는 개념 자체가 리소스이다.
- 계층 구조에서 상위 개념을 컬렉션(복수 형태)으로 표현하는 것이 권장된다.
  - 회원 목록 조회: `/members`
  - 회원 조회, 등록, 수정, 삭제: `/members/{id}` → 행위 구분 필요.

#### 1.1.2 리소스와 행위를 분리

- URI는 리소스를 식별하는 역할만 한다.
- 행위(메서드)는 URI가 아닌 HTTP 메서드로 표현한다.
- 리소스는 명사, 행위는 동사로 구분한다.

## 2. HTTP 메서드 - GET, POST

### 2.1 HTTP 메서드 종류

- GET: 리소스 조회
- POST: 요청 데이터 처리, 주로 등록에 사용
- PUT: 리소스를 대체, 해당 리소스가 없으면 생성
- PATCH: 리소스 부분 변경
- DELETE: 리소스 삭제
- HEAD: GET과 동일하지만 메시지 부분을 제외하고, 상태 줄과 헤더만 반환
- OPTIONS: 대상 리소스에 대한 통신 가능 옵션(메서드)을 설명(주로 CORS에서 사용)
- CONNECT: 대상 자원에서 식별되는 서버에 대한 터널을 설정
- TRACE: 대상 리소스에 대한 경로를 따라 메시지 루프백 테스트를 수행

### 2.2 GET 메서드

- 예제: `/members/100`
- **리소스 조회에 사용된다**.
- 서버에 데이터를 전달할 때는 쿼리 스트링(쿼리 파라미터)을 사용한다.
- 메시지 바디로 데이터를 전달할 수도 있지만, 지원하지 않는 환경이 많아 권장되지 않음.

### 2.3 POST 메서드

- 예제: `/members`
- 요청 데이터를 처리할 때 사용한다.
- 메시지 바디를 통해 데이터를 서버로 전달한다.
- 주로 새로운 리소스를 등록할 때 사용한다.
- 기존 리소스와 상관없는 프로세스를 실행할 때도 사용할 수 있다.
- 각 리소스마다 POST 요청을 처리하는 방식이 다를 수 있다.

## 3. HTTP 메서드 - PUT, PATCH, DELETE

### 3.1 PUT 메서드

- 예제: `/members/100`
- **리소스를 대체한다**.
  - 리소스가 존재하면 **전체 업데이트(덮어쓰기)**.
  - 리소스가 없으면 **새로 생성**.
- 클라이언트가 리소스를 식별하고 URI를 지정한다.
- POST와의 차이점:
  - POST: 서버가 리소스 위치를 결정.
  - PUT: 클라이언트가 리소스 위치를 결정.

### 3.2 PATCH 메서드

- 예제: `/members/100`
- **리소스의 일부를 변경한다**.

### 3.3 DELETE 메서드

- 예제: `/members/100`
- **리소스를 삭제한다**.

## 4. HTTP 메서드의 속성

### 4.1 안전 (Safe)

- **호출해도 리소스가 변경되지 않는다**.
- **GET, HEAD, OPTIONS, TRACE**는 안전한 메서드다.
- 계속 호출해서 로그 부분에서 장애가 발생한 경우는 고려하지 않는다. 안전은 해당 리소스만 고려한다.

### 4.2 멱등 (Idempotent)

- **f(f(x)) = f(x)**
- **한 번 호출하든 여러 번 호출하든 같은 결과가 나온다**.
- **멱등 메서드**:
  - **GET**: 여러 번 조회해도 같은 결과가 조회된다.
  - **PUT**: 결과를 대체한다. 따라서 여러 번 호출해도 최종 결과가 동일하다.
  - **DELETE**: 같은 요청을 여러 번 해도 삭제된 결과는 똑같다.
  - **POST는 멱등이 아님**: 같은 요청을 여러 번 보내면 중복 데이터가 생성될 수 있다.
- 멱등은 외부 요인(재요청 중간에 다른 곳에서 리소스를 변경하는 경우)으로 중간에 리소스가 변경되는 것까지는 고려하지 않는다.
- 활용 사례:
  - **자동 복구 메커니즘**.
  - **서버 타임아웃 발생으로 정상적인 응답을 하지 못했을 때 클라이언트가 동일한 요청을 다시 보내도 괜찮은지 판단하는 근거가 된다.**

### 4.3 캐시 가능 (Cacheable)

- **응답 결과 리소스를 캐싱하는 기능이다**.
- GET, HEAD, POST, PATCH는 캐싱이 가능하다.
- **실제로는 GET, HEAD만 주로 캐싱한다.**
  - POST, PATCH는 본문 내용을 캐시 키로 고려해야 하므로 구현이 복잡하다.
