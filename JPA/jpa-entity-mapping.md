# 엔티티 매핑

## 엔티티 매핑 정리

| 매핑 대상              | 어노테이션                  |
| ---------------------- | --------------------------- |
| **객체와 테이블 매핑** | `@Entity`, `@Table`         |
| **필드와 컬럼 매핑**   | `@Column`                   |
| **기본 키 매핑**       | `@Id`                       |
| **연관관계 매핑**      | `@ManyToOne`, `@JoinColumn` |

## @Entity

- @Entity가 붙은 클래스는 JPA가 관리하는 엔티티 객체이다.
- 기본 생성자(파라미터가 없는 public 또는 protected 생성자)가 필수이다.
  - JPA는 리플렉션을 이용해 객체를 생성하고 관리하기 때문에 기본 생성자가 필요하다.
- 제약사항
  - final 클래스, enum, interface, inner class에는 @Entity를 사용할 수 없다.
  - 영속 필드(DB에 저장할 필드)에 final을 사용할 수 없다.

### @Entity 속성

| 속성     | 설명                                                                  |
| -------- | --------------------------------------------------------------------- |
| `name`   | JPA에서 사용할 엔티티 이름을 지정 <br> (기본값: 클래스 이름)          |
| `@Table` | 엔티티와 매핑할 **테이블명**을 지정 <br> (기본값: 클래스 이름과 동일) |

## 데이터베이스 스키마 자동 생성

### `hibernate.hbm2ddl.auto` 옵션

| 옵션          | 설명                                                       |
| ------------- | ---------------------------------------------------------- |
| `create`      | 기존 테이블을 삭제 후 다시 생성 (DROP + CREATE)            |
| `create-drop` | `create`와 동일하지만, 애플리케이션 종료 시 테이블을 삭제  |
| `update`      | 변경 사항만 반영 (운영 DB에서는 사용 금지)                 |
| `validate`    | 엔티티와 테이블이 정상적으로 매핑되었는지 검증 (변경 없음) |
| `none`        | 자동 생성 기능을 사용하지 않음                             |

### 주의 사항

- 운영 환경에서는 `create`, `create-drop`, `update` 사용 금지
- 환경별 권장 설정
  - 개발 초기 단계: `create` 또는 `update`
  - 테스트 서버: `update` 또는 `validate`
  - 스테이징 및 운영 서버: `validate` 또는 `none`
- DDL 생성 기능은 애플리케이션 실행 시 테이블을 생성할 때만 사용되며, JPA의 실행 로직에는 영향을 주지 않는다.
  - 예: 유니크 제약 조건 추가 등 DDL 관련 설정은 반영되지만, 런타임 동작에는 영향 없음
